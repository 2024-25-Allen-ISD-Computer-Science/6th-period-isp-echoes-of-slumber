import pygame
import sys

pygame.init()

# screen setup
WIDTH, HEIGHT = 1375, 700
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("Game")

# font setup
dialogueFont = pygame.font.Font("januaryNight/januaryNight.ttf", 36)

# temp color setup
WHITE = (255, 255, 255)
BLUE = (0, 0, 255)
BLACK = (0, 0, 0)

# character setup
shopkeeperSprite = pygame.image.load("shopkeeperSprite.png")
shopkeeperSprite = pygame.transform.scale(shopkeeperSprite, (190, 250))
characterRect = shopkeeperSprite.get_rect(topleft=(300, 200))

# dialogue setup
dialogue_text = "Would you like to purchase something?"
# holds what text is currently displayed
current_text = ""
# tracks # of characters to display
text_index = 0
# num of frames between each character's appearance
typing_speed = 3
typing_counter = 0

show_dialogue = False


# main loop
clock = pygame.time.Clock()
running = True
while running:
    screen.fill(WHITE)

    # drawing the character
    screen.blit(shopkeeperSprite, characterRect)

    # user interaction
    # if user quits the game, stop clock
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False
        # if character is clicked, show dialogue
        if event.type == pygame.MOUSEBUTTONDOWN:
            if characterRect.collidepoint(event.pos):
                show_dialogue = True
                # reset displayed text
                current_text = ""
                text_index = 0
                typing_counter = 0

    if show_dialogue:
            dialogue_box = pygame.Rect(150, 450, 500, 100)  # box dimensions
            pygame.draw.rect(screen, (92, 95, 127), dialogue_box)
            pygame.draw.rect(screen, (202, 211, 228), dialogue_box.inflate(-10, -10))  # inner border

            # text animation
            if text_index < len(dialogue_text):
                 typing_counter += 1
                 if typing_counter % typing_speed == 0:
                      text_index += 1
                      current_text = dialogue_text[:text_index]
            
            text_surface = dialogueFont.render(current_text, True, (115, 98, 86))
            screen.blit(text_surface, (dialogue_box.x + 20, dialogue_box.y + 35))
    
    # update display
    pygame.display.flip()
    # set tick/framerate
    clock.tick(60)




